1688112584
da8df4e7f502dc9ea26bc906a670dcb8-AwuilbDvXz%3Af67270a350aea7ca93be8f0a51a9071d-78177586fa912ac34f8644b20f1bbeba
s:45800:"TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlIjoxNDp7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBkb2NCbG9jayI7TjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGhhc2giO3M6MzI6Ijc4MTc3NTg2ZmE5MTJhYzM0Zjg2NDRiMjBmMWJiZWJhIjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWUiO3M6NTI6ImNsYXNzLWNvbmZldHRpLWJpdHMtcmVzdC10cmFuc2FjdGlvbnMtZW5kcG9pbnQgMi5waHAiO3M6Mzk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAcGF0aCI7czo3NjoiY2ItdHJhbnNhY3Rpb25zL2NsYXNzZXMvY2xhc3MtY29uZmV0dGktYml0cy1yZXN0LXRyYW5zYWN0aW9ucy1lbmRwb2ludCAyLnBocCI7czo0MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBzb3VyY2UiO3M6MzMzNTI6Ijw/cGhwCgovKgoKZnVuY3Rpb25zIHdlIG5lZWQ6CmNiX3Jlc3RfdHJhbnNhY3Rpb25fZGVmYXVsdF9zY29wZQpjYl90cmFuc2FjdGlvbl9nZXQgKGNiX3RyYW5zYWN0aW9uX2dldCkKY2JfcmVzdF9yZXNwb25zZV9hZGRfdG90YWxfaGVhZGVycwpjYl90cmFuc2FjdGlvbl9wb3N0X3VwZGF0ZSAoY2JfdHJhbnNhY3Rpb25fcG9zdF91cGRhdGUpCmNiX3RyYW5zYWN0aW9uX3VzZXJfY2FuX2RlbGV0ZSAoY2JfdHJhbnNhY3Rpb25fdXNlcl9jYW5fZGVsZXRlKQpjYl90cmFuc2FjdGlvbl9nZXRfc3BlY2lmaWMgKGNiX3RyYW5zYWN0aW9uX2dldF9zcGVjaWZpYykKY2JfdHJhbnNhY3Rpb25fZGVsZXRlIChjYl90cmFuc2FjdGlvbl9kZWxldGUpCmNiX3RyYW5zYWN0aW9uX2dldF9wZXJtYWxpbmsKCiovCgovKi8KY2xhc3MgQ29uZmV0dGlfQml0c19SRVNUX1RyYW5zYWN0aW9uc19FbmRwb2ludCBleHRlbmRzIFdQX1JFU1RfQ29udHJvbGxlcgp7CgoJcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkKCXsKCQkkdGhpcy0+bmFtZXNwYWNlID0gY2JfcmVzdF9uYW1lc3BhY2UoKSAuICcvJyAuIGNiX3Jlc3RfdmVyc2lvbigpOwoJCSR0aGlzLT5yZXN0X2Jhc2UgPSBDb25mZXR0aV9CaXRzKCktPnRyYW5zYWN0aW9ucy0+aWQ7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIHJlZ2lzdGVyX3JvdXRlcygpCgl7CgkJcmVnaXN0ZXJfcmVzdF9yb3V0ZSgKCQkJJHRoaXMtPm5hbWVzcGFjZSwKCQkJJy8nIC4gJHRoaXMtPnJlc3RfYmFzZSwKCQkJYXJyYXkoCgkJCQlhcnJheSgKCQkJCQknbWV0aG9kcycgPT4gV1BfUkVTVF9TZXJ2ZXI6OlJFQURBQkxFLAoJCQkJCSdjYWxsYmFjaycgPT4gYXJyYXkoJHRoaXMsICdnZXRfaXRlbXMnKSwKCQkJCQkncGVybWlzc2lvbl9jYWxsYmFjaycgPT4gYXJyYXkoJHRoaXMsICdnZXRfaXRlbXNfcGVybWlzc2lvbnNfY2hlY2snKSwKCQkJCQknYXJncycgPT4gJHRoaXMtPmdldF9jb2xsZWN0aW9uX3BhcmFtcygpLAoJCQkJKSwKCQkJCWFycmF5KAoJCQkJCSdtZXRob2RzJyA9PiBXUF9SRVNUX1NlcnZlcjo6Q1JFQVRBQkxFLAoJCQkJCSdjYWxsYmFjaycgPT4gYXJyYXkoJHRoaXMsICdjcmVhdGVfaXRlbScpLAoJCQkJCSdwZXJtaXNzaW9uX2NhbGxiYWNrJyA9PiBhcnJheSgkdGhpcywgJ2NyZWF0ZV9pdGVtX3Blcm1pc3Npb25zX2NoZWNrJyksCgkJCQkJJ2FyZ3MnID0+ICR0aGlzLT5nZXRfZW5kcG9pbnRfYXJnc19mb3JfaXRlbV9zY2hlbWEoV1BfUkVTVF9TZXJ2ZXI6OkNSRUFUQUJMRSksCgkJCQkpLAoJCQkJJ3NjaGVtYScgPT4gYXJyYXkoJHRoaXMsICdnZXRfaXRlbV9zY2hlbWEnKSwKCQkJKQoJCSk7CgoJCSR0cmFuc2FjdGlvbl9lbmRwb2ludCA9ICcvJyAuICR0aGlzLT5yZXN0X2Jhc2UgLiAnLyg/UDxpZD5bXGRdKyknOwoKCQlyZWdpc3Rlcl9yZXN0X3JvdXRlKAoJCQkkdGhpcy0+bmFtZXNwYWNlLAoJCQkkdHJhbnNhY3Rpb25fZW5kcG9pbnQsCgkJCWFycmF5KAoJCQkJJ2FyZ3MnID0+IGFycmF5KAoJCQkJCSdpZCcgPT4gYXJyYXkoCgkJCQkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ0EgdW5pcXVlIG51bWVyaWMgSUQgZm9yIHRoZSB0cmFuc2FjdGlvbi4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJCQkndHlwZScgPT4gJ2ludGVnZXInLAoJCQkJCSksCgkJCQkpLAoJCQkJYXJyYXkoCgkJCQkJJ21ldGhvZHMnID0+IFdQX1JFU1RfU2VydmVyOjpSRUFEQUJMRSwKCQkJCQknY2FsbGJhY2snID0+IGFycmF5KCR0aGlzLCAnZ2V0X2l0ZW0nKSwKCQkJCQkncGVybWlzc2lvbl9jYWxsYmFjaycgPT4gYXJyYXkoJHRoaXMsICdnZXRfaXRlbV9wZXJtaXNzaW9uc19jaGVjaycpLAoJCQkJCSdhcmdzJyA9PiBhcnJheSgKCQkJCQkJJ2NvbnRleHQnID0+ICR0aGlzLT5nZXRfY29udGV4dF9wYXJhbSgKCQkJCQkJCWFycmF5KAoJCQkJCQkJCSdkZWZhdWx0JyA9PiAndmlldycsCgkJCQkJCQkpCgkJCQkJCSksCgkJCQkJKSwKCQkJCSksCgkJCQlhcnJheSgKCQkJCQknbWV0aG9kcycgPT4gV1BfUkVTVF9TZXJ2ZXI6OkVESVRBQkxFLAoJCQkJCSdjYWxsYmFjaycgPT4gYXJyYXkoJHRoaXMsICd1cGRhdGVfaXRlbScpLAoJCQkJCSdwZXJtaXNzaW9uX2NhbGxiYWNrJyA9PiBhcnJheSgkdGhpcywgJ3VwZGF0ZV9pdGVtX3Blcm1pc3Npb25zX2NoZWNrJyksCgkJCQkJJ2FyZ3MnID0+ICR0aGlzLT5nZXRfZW5kcG9pbnRfYXJnc19mb3JfaXRlbV9zY2hlbWEoV1BfUkVTVF9TZXJ2ZXI6OkVESVRBQkxFKSwKCQkJCSksCgkJCQlhcnJheSgKCQkJCQknbWV0aG9kcycgPT4gV1BfUkVTVF9TZXJ2ZXI6OkRFTEVUQUJMRSwKCQkJCQknY2FsbGJhY2snID0+IGFycmF5KCR0aGlzLCAnZGVsZXRlX2l0ZW0nKSwKCQkJCQkncGVybWlzc2lvbl9jYWxsYmFjaycgPT4gYXJyYXkoJHRoaXMsICdkZWxldGVfaXRlbV9wZXJtaXNzaW9uc19jaGVjaycpLAoJCQkJKSwKCQkJCSdzY2hlbWEnID0+IGFycmF5KCR0aGlzLCAnZ2V0X2l0ZW1fc2NoZW1hJyksCgkJCSkKCQkpOwoJfQoKCS8qKgoJICogUmV0cmlldmUgYWN0aXZpdGllcy4KCSAqCgkgKiBAcGFyYW0gV1BfUkVTVF9SZXF1ZXN0ICRyZXF1ZXN0IEZ1bGwgZGV0YWlscyBhYm91dCB0aGUgcmVxdWVzdC4KCSAqCgkgKiBAcmV0dXJuIFdQX1JFU1RfUmVzcG9uc2UgfCBXUF9FcnJvcgoJICogQHNpbmNlIDAuMS4wCgkgKgoJICogQGFwaSB7R0VUfSAvd3AtanNvbi9jb25mZXR0aS1iaXRzL3YxL3RyYW5zYWN0aW9uIEdldCBBY3Rpdml0aWVzCgkgKiBAYXBpTmFtZSBHZXRDQlRyYW5zY3Rpb25zCgkgKiBAYXBpR3JvdXAgVHJhbnNhY3Rpb25zCgkgKiBAYXBpRGVzY3JpcHRpb24gUmV0cmlldmUgdHJhbnNhY3Rpb25zCgkgKiBAYXBpVmVyc2lvbiAxLjAuMAoJICogQGFwaVBlcm1pc3Npb24gTG9nZ2VkSW5Vc2VyIGlmIHRoZSBzaXRlIGlzIGluIFByaXZhdGUgTmV0d29yay4KCSAqIEBhcGlQYXJhbSB7TnVtYmVyfSBbcGFnZV0gQ3VycmVudCBwYWdlIG9mIHRoZSBjb2xsZWN0aW9uLgoJICogQGFwaVBhcmFtIHtOdW1iZXJ9IFtwZXJfcGFnZT0xMF0gTWF4aW11bSBudW1iZXIgb2YgaXRlbXMgdG8gYmUgcmV0dXJuZWQgaW4gcmVzdWx0IHNldC4KCSAqIEBhcGlQYXJhbSB7U3RyaW5nfSBbc2VhcmNoXSBMaW1pdCByZXN1bHRzIHRvIHRob3NlIG1hdGNoaW5nIGEgc3RyaW5nLgoJICogQGFwaVBhcmFtIHtBcnJheX0gW2V4Y2x1ZGVdIEVuc3VyZSByZXN1bHQgc2V0IGV4Y2x1ZGVzIHNwZWNpZmljIElEcy4KCSAqIEBhcGlQYXJhbSB7QXJyYXl9IFtpbmNsdWRlXSBFbnN1cmUgcmVzdWx0IHNldCBpbmNsdWRlcyBzcGVjaWZpYyBJRHMuCgkgKiBAYXBpUGFyYW0ge0FycmF5PWFzYyxkZXNjfSBbb3JkZXI9ZGVzY10gRW5zdXJlIHJlc3VsdCBzZXQgaW5jbHVkZXMgc3BlY2lmaWMgSURzLgoJICogQGFwaVBhcmFtIHtTdHJpbmd9IFthZnRlcl0gTGltaXQgcmVzdWx0IHNldCB0byBpdGVtcyBwdWJsaXNoZWQgYWZ0ZXIgYSBnaXZlbiBJU084NjAxIGNvbXBsaWFudCBkYXRlLgoJICogQGFwaVBhcmFtIHtOdW1iZXJ9IFt1c2VyX2lkXSBMaW1pdCByZXN1bHQgc2V0IHRvIGl0ZW1zIGNyZWF0ZWQgYnkgYSBzcGVjaWZpYyB1c2VyIChJRCkuCgkgKiBAYXBpUGFyYW0ge1N0cmluZz1qdXN0LW1lLGZyaWVuZHMsZ3JvdXBzLGZhdm9yaXRlcyxtZW50aW9ucyxmb2xsb3dpbmd9IFtzY29wZV0gTGltaXQgcmVzdWx0IHNldCB0byBpdGVtcyB3aXRoIGEgc3BlY2lmaWMgc2NvcGUuCgkgKiBAYXBpUGFyYW0ge051bWJlcn0gW3ByaW1hcnlfaWRdIExpbWl0IHJlc3VsdCBzZXQgdG8gaXRlbXMgd2l0aCBhIHNwZWNpZmljIHByaW1lIGFzc29jaWF0aW9uIElELgoJICogQGFwaVBhcmFtIHtOdW1iZXJ9IFtzZWNvbmRhcnlfaWRdIExpbWl0IHJlc3VsdCBzZXQgdG8gaXRlbXMgd2l0aCBhIHNwZWNpZmljIHNlY29uZGFyeSBhc3NvY2lhdGlvbiBJRC4KCSAqIEBhcGlQYXJhbSB7U3RyaW5nfSBbY29tcG9uZW50XSBMaW1pdCByZXN1bHQgc2V0IHRvIGl0ZW1zIHdpdGggYSBzcGVjaWZpYyBhY3RpdmUgY29tcG9uZW50LgoJICogQGFwaVBhcmFtIHtTdHJpbmd9IFt0eXBlXSBMaW1pdCByZXN1bHQgc2V0IHRvIGl0ZW1zIHdpdGggYSBzcGVjaWZpYyB0cmFuc2FjdGlvbiB0eXBlLgoJICovCi8qLwoJcHVibGljIGZ1bmN0aW9uIGdldF9pdGVtcygkcmVxdWVzdCkKCXsKCQkkYXJncyA9IGFycmF5KAoJCQknZXhjbHVkZScgPT4gJHJlcXVlc3RbJ2V4Y2x1ZGUnXSwKCQkJJ2luJyA9PiAkcmVxdWVzdFsnaW5jbHVkZSddLAoJCQkncGFnZScgPT4gJHJlcXVlc3RbJ3BhZ2UnXSwKCQkJJ3Blcl9wYWdlJyA9PiAkcmVxdWVzdFsncGVyX3BhZ2UnXSwKCQkJJ3NlYXJjaF90ZXJtcycgPT4gJHJlcXVlc3RbJ3NlYXJjaCddLAoJCQknc29ydCcgPT4gJHJlcXVlc3RbJ29yZGVyJ10sCgkJCSdzcGFtJyA9PiAkcmVxdWVzdFsnc3RhdHVzJ10sCgkJCSdzY29wZScgPT4gJHJlcXVlc3RbJ3Njb3BlJ10sCgkJCSdjb3VudF90b3RhbCcgPT4gdHJ1ZSwKCQkJJ2ZpZWxkcycgPT4gJ2FsbCcsCgkJCSdzaG93X2hpZGRlbicgPT4gZmFsc2UsCgkJCSd1cGRhdGVfbWV0YV9jYWNoZScgPT4gdHJ1ZSwKCQkJJ2ZpbHRlcicgPT4gZmFsc2UsCgkJKTsKCgkJaWYgKGVtcHR5KCRyZXF1ZXN0WydleGNsdWRlJ10pKSB7CgkJCSRhcmdzWydleGNsdWRlJ10gPSBmYWxzZTsKCQl9CgoJCWlmIChlbXB0eSgkcmVxdWVzdFsnaW5jbHVkZSddKSkgewoJCQkkYXJnc1snaW4nXSA9IGZhbHNlOwoJCX0KCgkJaWYgKGlzc2V0KCRyZXF1ZXN0WydhZnRlciddKSkgewoJCQkkYXJnc1snc2luY2UnXSA9ICRyZXF1ZXN0WydhZnRlciddOwoJCX0KCgkJaWYgKGlzc2V0KCRyZXF1ZXN0Wyd1c2VyX2lkJ10pKSB7CgkJCSRhcmdzWydmaWx0ZXInXVsndXNlcl9pZCddID0gJHJlcXVlc3RbJ3VzZXJfaWQnXTsKCQl9CgoJCSRpdGVtX2lkID0gMDsKCgkJaWYgKGVtcHR5KCRyZXF1ZXN0WydzY29wZSddKSkgewoJCQkkYXJnc1snc2NvcGUnXSA9IGZhbHNlOwoJCX0KCgkJaWYgKGlzc2V0KCRyZXF1ZXN0Wyd0eXBlJ10pKSB7CgkJCSRhcmdzWydmaWx0ZXInXVsnYWN0aW9uJ10gPSAkcmVxdWVzdFsndHlwZSddOwoJCX0KCgkJaWYgKCFlbXB0eSgkcmVxdWVzdFsnc2Vjb25kYXJ5X2lkJ10pKSB7CgkJCSRhcmdzWydmaWx0ZXInXVsnc2Vjb25kYXJ5X2lkJ10gPSAkcmVxdWVzdFsnc2Vjb25kYXJ5X2lkJ107CgkJfQoKCQlpZiAoJGFyZ3NbJ2luJ10pIHsKCQkJJGFyZ3NbJ2NvdW50X3RvdGFsJ10gPSBmYWxzZTsKCQl9CgoJCSRhcmdzWydzY29wZSddID0gJHRoaXMtPmNiX3Jlc3RfdHJhbnNhY3Rpb25fZGVmYXVsdF9zY29wZSgkYXJnc1snc2NvcGUnXSwgKCRyZXF1ZXN0Wyd1c2VyX2lkJ10gPyAkcmVxdWVzdFsndXNlcl9pZCddIDogMCksICRhcmdzWydncm91cF9pZCddKTsKCgkJJGFyZ3MgPSBhcHBseV9maWx0ZXJzKCdjYl9yZXN0X3RyYW5zYWN0aW9uX2dldF9pdGVtc19xdWVyeV9hcmdzJywgJGFyZ3MsICRyZXF1ZXN0KTsKCgkJLy8gQWN0dWFsbHksIHF1ZXJ5IGl0LgoJCSRhY3Rpdml0aWVzID0gY2JfdHJhbnNhY3Rpb25fZ2V0KCRhcmdzKTsKCgkJJHJldHZhbCA9IGFycmF5KCk7CgkJZm9yZWFjaCAoJHRyYW5zYWN0aW9uc1sndHJhbnNhY3Rpb25zJ10gYXMgJHRyYW5zYWN0aW9uKSB7CgkJCSRyZXR2YWxbXSA9ICR0aGlzLT5wcmVwYXJlX3Jlc3BvbnNlX2Zvcl9jb2xsZWN0aW9uKAoJCQkJJHRoaXMtPnByZXBhcmVfaXRlbV9mb3JfcmVzcG9uc2UoJHRyYW5zYWN0aW9uLCAkcmVxdWVzdCkKCQkJKTsKCQl9CgoJCSRyZXNwb25zZSA9IHJlc3RfZW5zdXJlX3Jlc3BvbnNlKCRyZXR2YWwpOwoJCSRyZXNwb25zZSA9IGNiX3Jlc3RfcmVzcG9uc2VfYWRkX3RvdGFsX2hlYWRlcnMoJHJlc3BvbnNlLCAkdHJhbnNhY3Rpb25zWyd0b3RhbCddLCAkYXJnc1sncGVyX3BhZ2UnXSk7CgoJCQoJCWRvX2FjdGlvbignY2JfcmVzdF90cmFuc2FjdGlvbl9nZXRfaXRlbXMnLCAkdHJhbnNhY3Rpb25zLCAkcmVzcG9uc2UsICRyZXF1ZXN0KTsKCgkJcmV0dXJuICRyZXNwb25zZTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gZ2V0X2l0ZW1zX3Blcm1pc3Npb25zX2NoZWNrKCRyZXF1ZXN0KQoJewoJCSRyZXR2YWwgPSB0cnVlOwoKCQlpZiAoZnVuY3Rpb25fZXhpc3RzKCdjYl9lbmFibGVfcHJpdmF0ZV9uZXR3b3JrJykgJiYgdHJ1ZSAhPT0gY2JfZW5hYmxlX3ByaXZhdGVfbmV0d29yaygpICYmICFpc191c2VyX2xvZ2dlZF9pbigpKSB7CgkJCSRyZXR2YWwgPSBuZXcgV1BfRXJyb3IoCgkJCQknY2JfcmVzdF9hdXRob3JpemF0aW9uX3JlcXVpcmVkJywKCQkJCV9fKCdTb3JyeSwgdGhlIFJFU1QgQVBJIGlzIHJlc3RyaWN0ZWQgdG8gb25seSBsb2dnZWQtaW4gbWVtYmVycy4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJYXJyYXkoCgkJCQkJJ3N0YXR1cycgPT4gcmVzdF9hdXRob3JpemF0aW9uX3JlcXVpcmVkX2NvZGUoKSwKCQkJCSkKCQkJKTsKCQl9CgoJCXJldHVybiBhcHBseV9maWx0ZXJzKCdjYl9yZXN0X3RyYW5zYWN0aW9uX2dldF9pdGVtc19wZXJtaXNzaW9uc19jaGVjaycsICRyZXR2YWwsICRyZXF1ZXN0KTsKCX0KCgoJcHVibGljIGZ1bmN0aW9uIGdldF9pdGVtKCRyZXF1ZXN0KQoJewoJCSR0cmFuc2FjdGlvbiA9ICR0aGlzLT5nZXRfdHJhbnNhY3Rpb25fb2JqZWN0KCRyZXF1ZXN0KTsKCgkJaWYgKGVtcHR5KCR0cmFuc2FjdGlvbi0+aWQpKSB7CgkJCXJldHVybiBuZXcgV1BfRXJyb3IoCgkJCQknY2JfcmVzdF9pbnZhbGlkX2lkJywKCQkJCV9fKCdJbnZhbGlkIHRyYW5zYWN0aW9uIElELicsICdjb25mZXR0aS1iaXRzJyksCgkJCQlhcnJheSgKCQkJCQknc3RhdHVzJyA9PiA0MDQsCgkJCQkpCgkJCSk7CgkJfQoKCQkkcmV0dmFsID0gJHRoaXMtPnByZXBhcmVfcmVzcG9uc2VfZm9yX2NvbGxlY3Rpb24oCgkJCSR0aGlzLT5wcmVwYXJlX2l0ZW1fZm9yX3Jlc3BvbnNlKCR0cmFuc2FjdGlvbiwgJHJlcXVlc3QpCgkJKTsKCgkJJHJlc3BvbnNlID0gcmVzdF9lbnN1cmVfcmVzcG9uc2UoJHJldHZhbCk7CgoJCWRvX2FjdGlvbignY2JfcmVzdF90cmFuc2FjdGlvbl9nZXRfaXRlbScsICR0cmFuc2FjdGlvbiwgJHJlc3BvbnNlLCAkcmVxdWVzdCk7CgoJCXJldHVybiAkcmVzcG9uc2U7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGdldF9pdGVtX3Blcm1pc3Npb25zX2NoZWNrKCRyZXF1ZXN0KQoJewoJCSRyZXR2YWwgPSB0cnVlOwoKCQlpZiAoZnVuY3Rpb25fZXhpc3RzKCdjYl9lbmFibGVfcHJpdmF0ZV9uZXR3b3JrJykgJiYgdHJ1ZSAhPT0gY2JfZW5hYmxlX3ByaXZhdGVfbmV0d29yaygpICYmICFpc191c2VyX2xvZ2dlZF9pbigpKSB7CgkJCSRyZXR2YWwgPSBuZXcgV1BfRXJyb3IoCgkJCQknY2JfcmVzdF9hdXRob3JpemF0aW9uX3JlcXVpcmVkJywKCQkJCV9fKCdTb3JyeSwgUkVTVCBBUEkgYWNjZXNzIGlzIHJlc3RyaWN0ZWQgdG8gbG9nZ2VkLWluIG1lbWJlcnMgb25seS4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJYXJyYXkoCgkJCQkJJ3N0YXR1cycgPT4gcmVzdF9hdXRob3JpemF0aW9uX3JlcXVpcmVkX2NvZGUoKSwKCQkJCSkKCQkJKTsKCQl9CgoJCWlmICh0cnVlID09PSAkcmV0dmFsICYmICEkdGhpcy0+Y2FuX3NlZSgkcmVxdWVzdCkpIHsKCQkJJHJldHZhbCA9IG5ldyBXUF9FcnJvcigKCQkJCSdjYl9yZXN0X2F1dGhvcml6YXRpb25fcmVxdWlyZWQnLAoJCQkJX18oJ1NvcnJ5LCB5b3UgY2Fubm90IHZpZXcgQ29uZmV0dGkgQml0cyB0cmFuc2FjdGlvbnMuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCWFycmF5KAoJCQkJCSdzdGF0dXMnID0+IHJlc3RfYXV0aG9yaXphdGlvbl9yZXF1aXJlZF9jb2RlKCksCgkJCQkpCgkJCSk7CgkJfQoKCQlyZXR1cm4gYXBwbHlfZmlsdGVycygnY2JfcmVzdF90cmFuc2FjdGlvbl9nZXRfaXRlbV9wZXJtaXNzaW9uc19jaGVjaycsICRyZXR2YWwsICRyZXF1ZXN0KTsKCX0KCgoJcHVibGljIGZ1bmN0aW9uIGNyZWF0ZV9pdGVtKCRyZXF1ZXN0KQoJewoJCSRyZXF1ZXN0LT5zZXRfcGFyYW0oJ2NvbnRleHQnLCAnZWRpdCcpOwoKCQlpZiAodHJ1ZSA9PT0gJHRoaXMtPmNiX3Jlc3RfdHJhbnNhY3Rpb25fY29udGVudF92YWxpZGF0ZSgkcmVxdWVzdCkpIHsKCQkJcmV0dXJuIG5ldyBXUF9FcnJvcigKCQkJCSdjYl9yZXN0X2NyZWF0ZV90cmFuc2FjdGlvbl9lbXB0eV9jb250ZW50JywKCQkJCV9fKCdQbGVhc2UgZW50ZXIgYSBsb2cgZW50cnkuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCWFycmF5KAoJCQkJCSdzdGF0dXMnID0+IDQwMCwKCQkJCSkKCQkJKTsKCQl9CgoJCSRwcmVwYXJlZF90cmFuc2FjdGlvbiA9ICR0aGlzLT5wcmVwYXJlX2l0ZW1fZm9yX2RhdGFiYXNlKCRyZXF1ZXN0KTsKCgkJaWYgKCFpc3NldCgkcmVxdWVzdFsnaGlkZGVuJ10pICYmIGlzc2V0KCRwcmVwYXJlZF90cmFuc2FjdGlvbi0+aGlkZV9zaXRld2lkZSkpIHsKCQkJJHJlcXVlc3RbJ2hpZGRlbiddID0gJHByZXBhcmVkX3RyYW5zYWN0aW9uLT5oaWRlX3NpdGV3aWRlOwoJCX0KCgkJJHR5cGUgPSAndHJhbnNhY3Rpb25fdXBkYXRlJzsKCQlpZiAoIWVtcHR5KCRyZXF1ZXN0Wyd0eXBlJ10pKSB7CgkJCSR0eXBlID0gJHJlcXVlc3RbJ3R5cGUnXTsKCQl9CgoJCSRwcmltZSA9ICRyZXF1ZXN0WydwcmltYXJ5X2l0ZW1faWQnXTsKCQkkdHJhbnNhY3Rpb25faWQgPSAwOwoKCQkkdHJhbnNhY3Rpb25faWQgPSBjYl90cmFuc2FjdGlvbl9jcmVhdGUoJHByZXBhcmVkX3RyYW5zYWN0aW9uKTsKCgkJaWYgKCFpc19udW1lcmljKCR0cmFuc2FjdGlvbl9pZCkpIHsKCQkJcmV0dXJuIG5ldyBXUF9FcnJvcigKCQkJCSdjYl9yZXN0X3VzZXJfY2Fubm90X2NyZWF0ZV90cmFuc2FjdGlvbicsCgkJCQlfXygnQ2Fubm90IGNyZWF0ZSBuZXcgdHJhbnNhY3Rpb24uJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCWFycmF5KAoJCQkJCSdzdGF0dXMnID0+IDUwMCwKCQkJCSkKCQkJKTsKCQl9CgoJCSR0cmFuc2FjdGlvbiA9IGNiX3RyYW5zYWN0aW9uX2dldF9zcGVjaWZpYygKCQkJYXJyYXkoCgkJCQkndHJhbnNhY3Rpb25faWRzJyA9PiBhcnJheSgkdHJhbnNhY3Rpb25faWQpLAoJCQkpCgkJKTsKCgkJJHRyYW5zYWN0aW9uID0gY3VycmVudCgkdHJhbnNhY3Rpb25bJ3RyYW5zYWN0aW9ucyddKTsKCQkkZmllbGRzX3VwZGF0ZSA9ICR0aGlzLT51cGRhdGVfYWRkaXRpb25hbF9maWVsZHNfZm9yX29iamVjdCgkdHJhbnNhY3Rpb24sICRyZXF1ZXN0KTsKCgkJaWYgKGlzX3dwX2Vycm9yKCRmaWVsZHNfdXBkYXRlKSkgewoJCQlyZXR1cm4gJGZpZWxkc191cGRhdGU7CgkJfQoKCQkkcmV0dmFsID0gJHRoaXMtPnByZXBhcmVfcmVzcG9uc2VfZm9yX2NvbGxlY3Rpb24oCgkJCSR0aGlzLT5wcmVwYXJlX2l0ZW1fZm9yX3Jlc3BvbnNlKCR0cmFuc2FjdGlvbiwgJHJlcXVlc3QpCgkJKTsKCgkJJHJlc3BvbnNlID0gcmVzdF9lbnN1cmVfcmVzcG9uc2UoJHJldHZhbCk7CgoJCWRvX2FjdGlvbignY2JfcmVzdF90cmFuc2FjdGlvbl9jcmVhdGVfaXRlbScsICR0cmFuc2FjdGlvbiwgJHJlc3BvbnNlLCAkcmVxdWVzdCk7CgoJCXJldHVybiAkcmVzcG9uc2U7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGNyZWF0ZV9pdGVtX3Blcm1pc3Npb25zX2NoZWNrKCRyZXF1ZXN0KQoJewoJCSRyZXR2YWwgPSB0cnVlOwoKCQlpZiAoIWlzX3VzZXJfbG9nZ2VkX2luKCkpIHsKCQkJJHJldHZhbCA9IG5ldyBXUF9FcnJvcigKCQkJCSdjYl9yZXN0X2F1dGhvcml6YXRpb25fcmVxdWlyZWQnLAoJCQkJX18oJ1NvcnJ5LCB5b3UgYXJlIG5vdCBhbGxvd2VkIHRvIGNyZWF0ZSB0cmFuc2FjdGlvbnMuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCWFycmF5KAoJCQkJCSdzdGF0dXMnID0+IHJlc3RfYXV0aG9yaXphdGlvbl9yZXF1aXJlZF9jb2RlKCksCgkJCQkpCgkJCSk7CgkJfQoKCQlyZXR1cm4gYXBwbHlfZmlsdGVycygnY2JfcmVzdF90cmFuc2FjdGlvbl9jcmVhdGVfaXRlbV9wZXJtaXNzaW9uc19jaGVjaycsICRyZXR2YWwsICRyZXF1ZXN0KTsKCX0KCgkvKioKCSAqIFVwZGF0ZSBhIHRyYW5zYWN0aW9uLgoJICoKCSAqIEBwYXJhbSBXUF9SRVNUX1JlcXVlc3QgJHJlcXVlc3QgRnVsbCBkZXRhaWxzIGFib3V0IHRoZSByZXF1ZXN0LgoJICoKCSAqIEByZXR1cm4gV1BfUkVTVF9SZXNwb25zZSB8IFdQX0Vycm9yCgkgKiBAc2luY2UgMC4xLjAKCSAqCgkgKiBAYXBpIHtQQVRDSH0gL3dwLWpzb24vY29uZmV0dGktYml0cy92MS90cmFuc2FjdGlvbi86aWQgVXBkYXRlIHRyYW5zYWN0aW9uCgkgKiBAYXBpTmFtZSBVcGRhdGVDQlRyYW5zYWN0aW9uCgkgKiBAYXBpR3JvdXAgVHJhbnNhY3Rpb25zCgkgKiBAYXBpRGVzY3JpcHRpb24gVXBkYXRlIHNpbmdsZSB0cmFuc2FjdGlvbgoJICogQGFwaVZlcnNpb24gMS4wLjAKCSAqIEBhcGlQZXJtaXNzaW9uIExvZ2dlZEluVXNlcgoJICogQGFwaVBhcmFtIHtOdW1iZXJ9IGlkIEEgdW5pcXVlIG51bWVyaWMgSUQgZm9yIHRoZSB0cmFuc2FjdGlvbi4KCSAqIEBhcGlQYXJhbSB7TnVtYmVyfSBbcHJpbWFyeV9pdGVtX2lkXSBUaGUgSUQgb2Ygc29tZSBvdGhlciBvYmplY3QgcHJpbWFyaWx5IGFzc29jaWF0ZWQgd2l0aCB0aGlzIG9uZS4KCSAqIEBhcGlQYXJhbSB7TnVtYmVyfSBbc2Vjb25kYXJ5X2l0ZW1faWRdIFRoZSBJRCBvZiBzb21lIG90aGVyIG9iamVjdCBhbHNvIGFzc29jaWF0ZWQgd2l0aCB0aGlzIG9uZS4KCSAqIEBhcGlQYXJhbSB7TnVtYmVyfSBbdXNlcl9pZF0gVGhlIElEIGZvciB0aGUgYXV0aG9yIG9mIHRoZSB0cmFuc2FjdGlvbi4KCSAqIEBhcGlQYXJhbSB7c3RyaW5nfSBbbGlua10gVGhlIHBlcm1hbGluayB0byB0aGlzIHRyYW5zYWN0aW9uIG9uIHRoZSBzaXRlLgoJICogQGFwaVBhcmFtIHtTdHJpbmc9c2V0dGluZ3Msbm90aWZpY2F0aW9ucyxncm91cHMsZm9ydW1zLHRyYW5zYWN0aW9uLG1lZGlhLG1lc3NhZ2VzLGZyaWVuZHMsaW52aXRlcyxzZWFyY2gsbWVtYmVycyx4cHJvZmlsZSxibG9nc30gW2NvbXBvbmVudF0gVGhlIGFjdGl2ZSBjb21wb25lbnQgdGhlIHRyYW5zYWN0aW9uIHJlbGF0ZXMgdG8uCgkgKiBAYXBpUGFyYW0ge1N0cmluZz1uZXdfbWVtYmVyLG5ld19hdmF0YXIsdXBkYXRlZF9wcm9maWxlLHRyYW5zYWN0aW9uX3VwZGF0ZSxjcmVhdGVkX2dyb3VwLGpvaW5lZF9ncm91cCxncm91cF9kZXRhaWxzX3VwZGF0ZWQsYmNiX3RvcGljX2NyZWF0ZSxiY2JfcmVwbHlfY3JlYXRlLHRyYW5zYWN0aW9uX2NvbW1lbnQsZnJpZW5kc2hpcF9hY2NlcHRlZCxmcmllbmRzaGlwX2NyZWF0ZWQsbmV3X2Jsb2dfcG9zdCxuZXdfYmxvZ19jb21tZW50fSBbdHlwZV0gVGhlIHRyYW5zYWN0aW9uIHR5cGUgb2YgdGhlIHRyYW5zYWN0aW9uLgoJICogQGFwaVBhcmFtIHtTdHJpbmd9IFtjb250ZW50XSBBbGxvd2VkIEhUTUwgY29udGVudCBmb3IgdGhlIHRyYW5zYWN0aW9uLgoJICogQGFwaVBhcmFtIHtTdHJpbmd9IFtkYXRlXSBUaGUgZGF0ZSB0aGUgdHJhbnNhY3Rpb24gd2FzIHB1Ymxpc2hlZCwgaW4gdGhlIHNpdGUncyB0aW1lem9uZS4KCSAqIEBhcGlQYXJhbSB7Qm9vbGVhbj10cnVlLGZhbHNlfSBbaGlkZGVuXSBXaGV0aGVyIHRoZSB0cmFuc2FjdGlvbiBvYmplY3Qgc2hvdWxkIGJlIHNpdGV3aWRlIGhpZGRlbiBvciBub3QuCgkgKiBAYXBpUGFyYW0ge3N0cmluZz1wdWJsaWMsbG9nZ2VkaW4sb25seW1lLGZyaWVuZHMsbWVkaWF9IFtwcml2YWN5XSBQcml2YWN5IG9mIHRoZSB0cmFuc2FjdGlvbi4KCSAqIEBhcGlQYXJhbSB7QXJyYXl9IFtjYl9tZWRpYV9pZHNdIE1lZGlhIHNwZWNpZmljIElEcyB3aGVuIE1lZGlhIGNvbXBvbmVudCBpcyBlbmFibGUuCgkgKiBAYXBpUGFyYW0ge0FycmF5fSBbbWVkaWFfZ2lmXSBTYXZlIGdpZiBkYXRhIGludG8gdHJhbnNhY3Rpb24gd2hlbiBNZWRpYSBjb21wb25lbnQgaXMgZW5hYmxlLiBwYXJhbSh1cmwsbXA0KQoJICovCi8qLwoJcHVibGljIGZ1bmN0aW9uIHVwZGF0ZV9pdGVtKCRyZXF1ZXN0KQoJewoJCSRyZXF1ZXN0LT5zZXRfcGFyYW0oJ2NvbnRleHQnLCAnZWRpdCcpOwoJCSR0cmFuc2FjdGlvbl9vYmplY3QgPSAkdGhpcy0+cHJlcGFyZV9pdGVtX2Zvcl9kYXRhYmFzZSgkcmVxdWVzdCk7CgoJCWlmICgKCQkJKGVtcHR5KCR0cmFuc2FjdGlvbl9vYmplY3QtPmNvbnRlbnQpCgkJCQkvLyYmIGVtcHR5KGNiX3RyYW5zYWN0aW9uX2dldF9tZXRhKCR0cmFuc2FjdGlvbl9vYmplY3QtPmlkLCAnY2JfbWVkaWFfaWRzJywgdHJ1ZSkpCgkJCQkvLyYmIGVtcHR5KGNiX3RyYW5zYWN0aW9uX2dldF9tZXRhKCR0cmFuc2FjdGlvbl9vYmplY3QtPmlkLCAnX2dpZl9kYXRhJywgdHJ1ZSkpCgkJCSkgJiYgdHJ1ZSA9PT0gJHRoaXMtPmNiX3Jlc3RfdHJhbnNhY3Rpb25fY29udGVudF92YWxpZGF0ZSgkcmVxdWVzdCkKCQkpIHsKCQkJcmV0dXJuIG5ldyBXUF9FcnJvcigKCQkJCSdjYl9yZXN0X3VwZGF0ZV90cmFuc2FjdGlvbl9lbXB0eV9jb250ZW50JywKCQkJCV9fKCdQbGVhc2UsIGVudGVyIGEgbG9nIGVudHJ5LicsICdjb25mZXR0aS1iaXRzJyksCgkJCQlhcnJheSgKCQkJCQknc3RhdHVzJyA9PiA0MDAsCgkJCQkpCgkJCSk7CgkJfQoKCQkkdHJhbnNhY3Rpb25faWQgPSBjYl90cmFuc2FjdGlvbl9jcmVhdGUoJHRyYW5zYWN0aW9uX29iamVjdCk7CgoJCWlmICghaXNfbnVtZXJpYygkdHJhbnNhY3Rpb25faWQpKSB7CgkJCXJldHVybiBuZXcgV1BfRXJyb3IoCgkJCQknY2JfcmVzdF91c2VyX2Nhbm5vdF91cGRhdGVfdHJhbnNhY3Rpb24nLAoJCQkJX18oJ0Nhbm5vdCB1cGRhdGUgZXhpc3RpbmcgdHJhbnNhY3Rpb24uJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCWFycmF5KAoJCQkJCSdzdGF0dXMnID0+IDUwMCwKCQkJCSkKCQkJKTsKCQl9CgoJCSR0cmFuc2FjdGlvbiA9ICR0aGlzLT5nZXRfdHJhbnNhY3Rpb25fb2JqZWN0KCR0cmFuc2FjdGlvbl9pZCk7CgkJJGZpZWxkc191cGRhdGUgPSAkdGhpcy0+dXBkYXRlX2FkZGl0aW9uYWxfZmllbGRzX2Zvcl9vYmplY3QoJHRyYW5zYWN0aW9uLCAkcmVxdWVzdCk7CgoJCWlmIChpc193cF9lcnJvcigkZmllbGRzX3VwZGF0ZSkpIHsKCQkJcmV0dXJuICRmaWVsZHNfdXBkYXRlOwoJCX0KCgkJJHJldHZhbCA9ICR0aGlzLT5wcmVwYXJlX3Jlc3BvbnNlX2Zvcl9jb2xsZWN0aW9uKAoJCQkkdGhpcy0+cHJlcGFyZV9pdGVtX2Zvcl9yZXNwb25zZSgkdHJhbnNhY3Rpb24sICRyZXF1ZXN0KQoJCSk7CgoJCSRyZXNwb25zZSA9IHJlc3RfZW5zdXJlX3Jlc3BvbnNlKCRyZXR2YWwpOwoKCQlkb19hY3Rpb24oJ2NiX3Jlc3RfdHJhbnNhY3Rpb25fdXBkYXRlX2l0ZW0nLCAkdHJhbnNhY3Rpb24sICRyZXNwb25zZSwgJHJlcXVlc3QpOwoKCQlyZXR1cm4gJHJlc3BvbnNlOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiB1cGRhdGVfaXRlbV9wZXJtaXNzaW9uc19jaGVjaygkcmVxdWVzdCkKCXsKCQkkcmV0dmFsID0gdHJ1ZTsKCgkJaWYgKCFpc191c2VyX2xvZ2dlZF9pbigpKSB7CgkJCSRyZXR2YWwgPSBuZXcgV1BfRXJyb3IoCgkJCQknY2JfcmVzdF9hdXRob3JpemF0aW9uX3JlcXVpcmVkJywKCQkJCV9fKCdTb3JyeSwgeW91IGFyZSBub3QgYWxsb3dlZCB0byB1cGRhdGUgdGhpcyB0cmFuc2FjdGlvbi4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJYXJyYXkoCgkJCQkJJ3N0YXR1cycgPT4gcmVzdF9hdXRob3JpemF0aW9uX3JlcXVpcmVkX2NvZGUoKSwKCQkJCSkKCQkJKTsKCQl9CgoJCSR0cmFuc2FjdGlvbiA9ICR0aGlzLT5nZXRfdHJhbnNhY3Rpb25fb2JqZWN0KCRyZXF1ZXN0KTsKCgkJaWYgKHRydWUgPT09ICRyZXR2YWwgJiYgZW1wdHkoJHRyYW5zYWN0aW9uLT5pZCkpIHsKCQkJJHJldHZhbCA9IG5ldyBXUF9FcnJvcigKCQkJCSdjYl9yZXN0X2ludmFsaWRfaWQnLAoJCQkJX18oJ0ludmFsaWQgdHJhbnNhY3Rpb24gSUQuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCWFycmF5KAoJCQkJCSdzdGF0dXMnID0+IDQwNCwKCQkJCSkKCQkJKTsKCQl9CgoJCWlmICh0cnVlID09PSAkcmV0dmFsICYmICFjYl90cmFuc2FjdGlvbl91c2VyX2Nhbl9kZWxldGUoJHRyYW5zYWN0aW9uKSkgewoJCQkkcmV0dmFsID0gbmV3IFdQX0Vycm9yKAoJCQkJJ2NiX3Jlc3RfYXV0aG9yaXphdGlvbl9yZXF1aXJlZCcsCgkJCQlfXygnU29ycnksIHlvdSBhcmUgbm90IGFsbG93ZWQgdG8gdXBkYXRlIHRoaXMgdHJhbnNhY3Rpb24uJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCWFycmF5KAoJCQkJCSdzdGF0dXMnID0+IHJlc3RfYXV0aG9yaXphdGlvbl9yZXF1aXJlZF9jb2RlKCksCgkJCQkpCgkJCSk7CgkJfQoKCQlyZXR1cm4gYXBwbHlfZmlsdGVycygnY2JfcmVzdF90cmFuc2FjdGlvbl91cGRhdGVfaXRlbV9wZXJtaXNzaW9uc19jaGVjaycsICRyZXR2YWwsICRyZXF1ZXN0KTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gZGVsZXRlX2l0ZW0oJHJlcXVlc3QpCgl7CgkJJHJlcXVlc3QtPnNldF9wYXJhbSgnY29udGV4dCcsICdlZGl0Jyk7CgoJCSR0cmFuc2FjdGlvbiA9ICR0aGlzLT5nZXRfdHJhbnNhY3Rpb25fb2JqZWN0KCRyZXF1ZXN0KTsKCQkkcHJldmlvdXMgPSAkdGhpcy0+cHJlcGFyZV9pdGVtX2Zvcl9yZXNwb25zZSgkdHJhbnNhY3Rpb24sICRyZXF1ZXN0KTsKCgkJJHJldHZhbCA9IGNiX3RyYW5zYWN0aW9uX2RlbGV0ZSgKCQkJYXJyYXkoCgkJCQknaWQnID0+ICR0cmFuc2FjdGlvbi0+aWQsCgkJCSkKCQkpOwoKCQlpZiAoISRyZXR2YWwpIHsKCQkJcmV0dXJuIG5ldyBXUF9FcnJvcigKCQkJCSdjYl9yZXN0X3RyYW5zYWN0aW9uX2Nhbm5vdF9kZWxldGUnLAoJCQkJX18oJ0NvdWxkIG5vdCBkZWxldGUgdGhlIHRyYW5zYWN0aW9uLicsICdjb25mZXR0aS1iaXRzJyksCgkJCQlhcnJheSgKCQkJCQknc3RhdHVzJyA9PiA1MDAsCgkJCQkpCgkJCSk7CgkJfQoKCQkvLyBCdWlsZCB0aGUgcmVzcG9uc2UuCgkJJHJlc3BvbnNlID0gbmV3IFdQX1JFU1RfUmVzcG9uc2UoKTsKCQkkcmVzcG9uc2UtPnNldF9kYXRhKAoJCQlhcnJheSgKCQkJCSdkZWxldGVkJyA9PiB0cnVlLAoJCQkJJ3ByZXZpb3VzJyA9PiAkcHJldmlvdXMtPmdldF9kYXRhKCksCgkJCSkKCQkpOwoKCQlkb19hY3Rpb24oJ2NiX3Jlc3RfdHJhbnNhY3Rpb25fZGVsZXRlX2l0ZW0nLCAkdHJhbnNhY3Rpb24sICRyZXNwb25zZSwgJHJlcXVlc3QpOwoKCQlyZXR1cm4gJHJlc3BvbnNlOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBkZWxldGVfaXRlbV9wZXJtaXNzaW9uc19jaGVjaygkcmVxdWVzdCkKCXsKCQkkcmV0dmFsID0gdHJ1ZTsKCgkJaWYgKCFpc191c2VyX2xvZ2dlZF9pbigpKSB7CgkJCSRyZXR2YWwgPSBuZXcgV1BfRXJyb3IoCgkJCQknY2JfcmVzdF9hdXRob3JpemF0aW9uX3JlcXVpcmVkJywKCQkJCV9fKCdTb3JyeSwgeW91IGFyZSBub3QgYWxsb3dlZCB0byBkZWxldGUgdGhpcyB0cmFuc2FjdGlvbi4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJYXJyYXkoCgkJCQkJJ3N0YXR1cycgPT4gcmVzdF9hdXRob3JpemF0aW9uX3JlcXVpcmVkX2NvZGUoKSwKCQkJCSkKCQkJKTsKCQl9CgoJCSR0cmFuc2FjdGlvbiA9ICR0aGlzLT5nZXRfdHJhbnNhY3Rpb25fb2JqZWN0KCRyZXF1ZXN0KTsKCgkJaWYgKHRydWUgPT09ICRyZXR2YWwgJiYgZW1wdHkoJHRyYW5zYWN0aW9uLT5pZCkpIHsKCQkJJHJldHZhbCA9IG5ldyBXUF9FcnJvcigKCQkJCSdjYl9yZXN0X2ludmFsaWRfaWQnLAoJCQkJX18oJ0ludmFsaWQgdHJhbnNhY3Rpb24gSUQuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCWFycmF5KAoJCQkJCSdzdGF0dXMnID0+IDQwNCwKCQkJCSkKCQkJKTsKCQl9CgoJCWlmICh0cnVlID09PSAkcmV0dmFsICYmICFjYl90cmFuc2FjdGlvbl91c2VyX2Nhbl9kZWxldGUoJHRyYW5zYWN0aW9uKSkgewoJCQkkcmV0dmFsID0gbmV3IFdQX0Vycm9yKAoJCQkJJ2NiX3Jlc3RfYXV0aG9yaXphdGlvbl9yZXF1aXJlZCcsCgkJCQlfXygnU29ycnksIHlvdSBhcmUgbm90IGFsbG93ZWQgdG8gZGVsZXRlIHRoaXMgdHJhbnNhY3Rpb24uJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCWFycmF5KAoJCQkJCSdzdGF0dXMnID0+IHJlc3RfYXV0aG9yaXphdGlvbl9yZXF1aXJlZF9jb2RlKCksCgkJCQkpCgkJCSk7CgkJfQoKCQlyZXR1cm4gYXBwbHlfZmlsdGVycygnY2JfcmVzdF90cmFuc2FjdGlvbl9kZWxldGVfaXRlbV9wZXJtaXNzaW9uc19jaGVjaycsICRyZXR2YWwsICRyZXF1ZXN0KTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gcmVuZGVyX2l0ZW0oJHRyYW5zYWN0aW9uKQoJewoJCSRyZW5kZXJlZCA9ICcnOwoKCQlpZiAoZW1wdHkoJHRyYW5zYWN0aW9uLT5jb250ZW50KSkgewoJCQlyZXR1cm4gJHJlbmRlcmVkOwoJCX0KCgkJLy8gRG8gbm90IHRydW5jYXRlIGFjdGl2aXRpZXMuCgkJYWRkX2ZpbHRlcignY2JfdHJhbnNhY3Rpb25fbWF5YmVfdHJ1bmNhdGVfZW50cnknLCAnX19yZXR1cm5fZmFsc2UnKTsKCQkkdHJhbnNhY3Rpb25zX3RlbXBsYXRlID0gbnVsbDsKCgkJaWYgKGlzc2V0KCRHTE9CQUxTWyd0cmFuc2FjdGlvbnNfdGVtcGxhdGUnXSkpIHsKCQkJJHRyYW5zYWN0aW9uc190ZW1wbGF0ZSA9ICRHTE9CQUxTWyd0cmFuc2FjdGlvbnNfdGVtcGxhdGUnXTsKCQl9CgoJCSRHTE9CQUxTWyd0cmFuc2FjdGlvbnNfdGVtcGxhdGUnXSA9IG5ldyBzdGRDbGFzcygpOwoJCSRHTE9CQUxTWyd0cmFuc2FjdGlvbnNfdGVtcGxhdGUnXS0+dHJhbnNhY3Rpb24gPSAkdHJhbnNhY3Rpb247CgoJCS8vIGNiX3RyYW5zYWN0aW9uX2VtYmVkKCk7CgoJCSRyZW5kZXJlZCA9IGFwcGx5X2ZpbHRlcnNfcmVmX2FycmF5KAoJCQknY2JfZ2V0X3RyYW5zYWN0aW9uX2NvbnRlbnRfYm9keScsCgkJCWFycmF5KAoJCQkJJHRyYW5zYWN0aW9uLT5jb250ZW50LAoJCQkJJiR0cmFuc2FjdGlvbiwKCQkJKQoJCSk7CgoJCSRHTE9CQUxTWyd0cmFuc2FjdGlvbnNfdGVtcGxhdGUnXSA9ICR0cmFuc2FjdGlvbnNfdGVtcGxhdGU7CgoJCS8vIFJlc3RvcmUgdGhlIGZpbHRlciB0byB0cnVuY2F0ZSBhY3Rpdml0aWVzLgoJCXJlbW92ZV9maWx0ZXIoJ2NiX3RyYW5zYWN0aW9uX21heWJlX3RydW5jYXRlX2VudHJ5JywgJ19fcmV0dXJuX2ZhbHNlJyk7CgoJCXJldHVybiAkcmVuZGVyZWQ7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIHByZXBhcmVfaXRlbV9mb3JfcmVzcG9uc2UoJHRyYW5zYWN0aW9uLCAkcmVxdWVzdCkKCXsKCQlnbG9iYWwgJHRyYW5zYWN0aW9uc190ZW1wbGF0ZTsKCQkkdHJhbnNhY3Rpb25zX3RlbXBsYXRlID0gbmV3IFxzdGRDbGFzcygpOwoJCSR0cmFuc2FjdGlvbnNfdGVtcGxhdGUtPmRpc2FibGVfYmxvZ2ZvcnVtX3JlcGxpZXMgPSAoYm9vbCkgY2JfY29yZV9nZXRfcm9vdF9vcHRpb24oJ2NiLWRpc2FibGUtYmxvZ2ZvcnVtLWNvbW1lbnRzJyk7CgkJJHRyYW5zYWN0aW9uc190ZW1wbGF0ZS0+dHJhbnNhY3Rpb24gPSAkdHJhbnNhY3Rpb247CgoJCSRkYXRhID0gYXJyYXkoCgkJCSd1c2VyX2lkJyA9PiAkdHJhbnNhY3Rpb24tPnVzZXJfaWQsCgkJCSduYW1lJyA9PiBjYl9jb3JlX2dldF91c2VyX2Rpc3BsYXluYW1lKCR0cmFuc2FjdGlvbi0+dXNlcl9pZCksCgkJCSdjb21wb25lbnQnID0+ICR0cmFuc2FjdGlvbi0+Y29tcG9uZW50LAoJCQknY29udGVudCcgPT4gYXJyYXkoCgkJCQkncmF3JyA9PiAkdHJhbnNhY3Rpb24tPmNvbnRlbnQsCgkJCQkncmVuZGVyZWQnID0+ICR0aGlzLT5yZW5kZXJfaXRlbSgkdHJhbnNhY3Rpb24pLAoJCQkpLAoJCQknZGF0ZScgPT4gY2JfcmVzdF9wcmVwYXJlX2RhdGVfcmVzcG9uc2UoJHRyYW5zYWN0aW9uLT5kYXRlX3JlY29yZGVkKSwKCQkJJ2lkJyA9PiAkdHJhbnNhY3Rpb24tPmlkLAoJCQknbGluaycgPT4gY2JfdHJhbnNhY3Rpb25fZ2V0X3Blcm1hbGluaygkdHJhbnNhY3Rpb24tPmlkKSwKCQkJJ3ByaW1hcnlfaXRlbV9pZCcgPT4gJHRyYW5zYWN0aW9uLT5pdGVtX2lkLAoJCQknc2Vjb25kYXJ5X2l0ZW1faWQnID0+ICR0cmFuc2FjdGlvbi0+c2Vjb25kYXJ5X2l0ZW1faWQsCgkJCSd0aXRsZScgPT4gJHRyYW5zYWN0aW9uLT5hY3Rpb24sCgkJCSd0eXBlJyA9PiAkdHJhbnNhY3Rpb24tPnR5cGUsCgoJCQknY2FuX2RlbGV0ZScgPT4gY2JfdHJhbnNhY3Rpb25fdXNlcl9jYW5fZGVsZXRlKCR0cmFuc2FjdGlvbiksCgkJCSdjb250ZW50X3N0cmlwcGVkJyA9PiBodG1sX2VudGl0eV9kZWNvZGUod3Bfc3RyaXBfYWxsX3RhZ3MoJHRyYW5zYWN0aW9uLT5jb250ZW50KSksCgkJKTsKCgkJLy8gR2V0IGl0ZW0gc2NoZW1hLgoJCSRzY2hlbWEgPSAkdGhpcy0+Z2V0X2l0ZW1fc2NoZW1hKCk7CgoJCWlmICghZW1wdHkoJHNjaGVtYVsncHJvcGVydGllcyddWyd1c2VyX2F2YXRhciddKSkgewoJCQkkZGF0YVsndXNlcl9hdmF0YXInXSA9IGFycmF5KAoJCQkJJ2Z1bGwnID0+IGNiX2NvcmVfZmV0Y2hfYXZhdGFyKAoJCQkJCWFycmF5KAoJCQkJCQknaXRlbV9pZCcgPT4gJHRyYW5zYWN0aW9uLT51c2VyX2lkLAoJCQkJCQknaHRtbCcgPT4gZmFsc2UsCgkJCQkJCSd0eXBlJyA9PiAnZnVsbCcsCgkJCQkJKQoJCQkJKSwKCgkJCQkndGh1bWInID0+IGNiX2NvcmVfZmV0Y2hfYXZhdGFyKAoJCQkJCWFycmF5KAoJCQkJCQknaXRlbV9pZCcgPT4gJHRyYW5zYWN0aW9uLT51c2VyX2lkLAoJCQkJCQknaHRtbCcgPT4gZmFsc2UsCgkJCQkJKQoJCQkJKSwKCQkJKTsKCQl9CgoJCSRjb250ZXh0ID0gIWVtcHR5KCRyZXF1ZXN0Wydjb250ZXh0J10pID8gJHJlcXVlc3RbJ2NvbnRleHQnXSA6ICd2aWV3JzsKCQkkZGF0YSA9ICR0aGlzLT5hZGRfYWRkaXRpb25hbF9maWVsZHNfdG9fb2JqZWN0KCRkYXRhLCAkcmVxdWVzdCk7CgkJJGRhdGEgPSAkdGhpcy0+ZmlsdGVyX3Jlc3BvbnNlX2J5X2NvbnRleHQoJGRhdGEsICRjb250ZXh0KTsKCgkJJHJlc3BvbnNlID0gcmVzdF9lbnN1cmVfcmVzcG9uc2UoJGRhdGEpOwoJCSRyZXNwb25zZS0+YWRkX2xpbmtzKCR0aGlzLT5wcmVwYXJlX2xpbmtzKCR0cmFuc2FjdGlvbikpOwoKCQlyZXR1cm4gYXBwbHlfZmlsdGVycygnY2JfcmVzdF90cmFuc2FjdGlvbl9wcmVwYXJlX3ZhbHVlJywgJHJlc3BvbnNlLCAkcmVxdWVzdCwgJHRyYW5zYWN0aW9uKTsKCX0KCgoJLyoqCgkgKiBQcmVwYXJlIGFuIHRyYW5zYWN0aW9uIGZvciBjcmVhdGUgb3IgdXBkYXRlLgoJICoKCSAqIEBwYXJhbSBXUF9SRVNUX1JlcXVlc3QgJHJlcXVlc3QgUmVxdWVzdCBvYmplY3QuCgkgKgoJICogQHJldHVybiBzdGRDbGFzc3xXUF9FcnJvciBPYmplY3Qgb3IgV1BfRXJyb3IuCgkgKiBAc2luY2UgMC4xLjAKCSAqLwoKLyovCglwcm90ZWN0ZWQgZnVuY3Rpb24gcHJlcGFyZV9pdGVtX2Zvcl9kYXRhYmFzZSgkcmVxdWVzdCkKCXsKCQkkcHJlcGFyZWRfdHJhbnNhY3Rpb24gPSBuZXcgc3RkQ2xhc3MoKTsKCQkkc2NoZW1hID0gJHRoaXMtPmdldF9pdGVtX3NjaGVtYSgpOwoJCSR0cmFuc2FjdGlvbiA9ICR0aGlzLT5nZXRfdHJhbnNhY3Rpb25fb2JqZWN0KCRyZXF1ZXN0KTsKCgkJaWYgKCFlbXB0eSgkc2NoZW1hWydwcm9wZXJ0aWVzJ11bJ2lkJ10pICYmICFlbXB0eSgkdHJhbnNhY3Rpb24tPmlkKSkgewoJCQkkcHJlcGFyZWRfdHJhbnNhY3Rpb24gPSAkdHJhbnNhY3Rpb247CgkJCSRwcmVwYXJlZF90cmFuc2FjdGlvbi0+aWQgPSAkdHJhbnNhY3Rpb24tPmlkOwoJCX0KCgkJLy8gdHJhbnNhY3Rpb24gdXNlciBJRC4KCQlpZiAoIWVtcHR5KCRzY2hlbWFbJ3Byb3BlcnRpZXMnXVsndXNlcl9pZCddKSAmJiBpc3NldCgkcmVxdWVzdFsndXNlcl9pZCddKSkgewoJCQkkcHJlcGFyZWRfdHJhbnNhY3Rpb24tPnVzZXJfaWQgPSAoaW50KSAkcmVxdWVzdFsndXNlcl9pZCddOwoJCX0gZWxzZSB7CgkJCSRwcmVwYXJlZF90cmFuc2FjdGlvbi0+dXNlcl9pZCA9IGdldF9jdXJyZW50X3VzZXJfaWQoKTsKCQl9CgoJCS8vIHRyYW5zYWN0aW9uIGNvbXBvbmVudC4KCQlpZiAoIWVtcHR5KCRzY2hlbWFbJ3Byb3BlcnRpZXMnXVsnY29tcG9uZW50J10pICYmIGlzc2V0KCRyZXF1ZXN0Wydjb21wb25lbnQnXSkpIHsKCQkJJHByZXBhcmVkX3RyYW5zYWN0aW9uLT5jb21wb25lbnQgPSAkcmVxdWVzdFsnY29tcG9uZW50J107CgkJfSBlbHNlIHsKCQkJJHByZXBhcmVkX3RyYW5zYWN0aW9uLT5jb21wb25lbnQgPSBDb25mZXR0aV9CaXRzKCktPnRyYW5zYWN0aW9ucy0+aWQ7CgkJfQoKCQkvLyB0cmFuc2FjdGlvbiBJdGVtIElELgoJCWlmICghZW1wdHkoJHNjaGVtYVsncHJvcGVydGllcyddWydwcmltYXJ5X2l0ZW1faWQnXSkgJiYgaXNzZXQoJHJlcXVlc3RbJ3ByaW1hcnlfaXRlbV9pZCddKSkgewoJCQkkaXRlbV9pZCA9IChpbnQpICRyZXF1ZXN0WydwcmltYXJ5X2l0ZW1faWQnXTsKCQkJJHByZXBhcmVkX3RyYW5zYWN0aW9uLT5pdGVtX2lkID0gJGl0ZW1faWQ7CgkJfQoKCQkvLyBTZWNvbmRhcnkgSXRlbSBJRC4KCQlpZiAoIWVtcHR5KCRzY2hlbWFbJ3Byb3BlcnRpZXMnXVsnc2Vjb25kYXJ5X2l0ZW1faWQnXSkgJiYgaXNzZXQoJHJlcXVlc3RbJ3NlY29uZGFyeV9pdGVtX2lkJ10pKSB7CgkJCSRwcmVwYXJlZF90cmFuc2FjdGlvbi0+c2Vjb25kYXJ5X2l0ZW1faWQgPSAoaW50KSAkcmVxdWVzdFsnc2Vjb25kYXJ5X2l0ZW1faWQnXTsKCQl9CgoJCS8vIHRyYW5zYWN0aW9uIHR5cGUuCgkJaWYgKCFlbXB0eSgkc2NoZW1hWydwcm9wZXJ0aWVzJ11bJ3R5cGUnXSkgJiYgaXNzZXQoJHJlcXVlc3RbJ3R5cGUnXSkpIHsKCQkJJHByZXBhcmVkX3RyYW5zYWN0aW9uLT50eXBlID0gJHJlcXVlc3RbJ3R5cGUnXTsKCQl9CgoJCS8vIHRyYW5zYWN0aW9uIGNvbnRlbnQuCgkJaWYgKCFlbXB0eSgkc2NoZW1hWydwcm9wZXJ0aWVzJ11bJ2NvbnRlbnQnXSkgJiYgaXNzZXQoJHJlcXVlc3RbJ2NvbnRlbnQnXSkpIHsKCQkJaWYgKGlzX3N0cmluZygkcmVxdWVzdFsnY29udGVudCddKSkgewoJCQkJJHByZXBhcmVkX3RyYW5zYWN0aW9uLT5jb250ZW50ID0gJHJlcXVlc3RbJ2NvbnRlbnQnXTsKCQkJfSBlbHNlaWYgKGlzc2V0KCRyZXF1ZXN0Wydjb250ZW50J11bJ3JhdyddKSkgewoJCQkJJHByZXBhcmVkX3RyYW5zYWN0aW9uLT5jb250ZW50ID0gJHJlcXVlc3RbJ2NvbnRlbnQnXVsncmF3J107CgkJCX0KCQl9CgoJCXJldHVybiBhcHBseV9maWx0ZXJzKCdjYl9yZXN0X3RyYW5zYWN0aW9uX3ByZV9pbnNlcnRfdmFsdWUnLCAkcHJlcGFyZWRfdHJhbnNhY3Rpb24sICRyZXF1ZXN0KTsKCX0KCgoJcHJvdGVjdGVkIGZ1bmN0aW9uIHByZXBhcmVfbGlua3MoJHRyYW5zYWN0aW9uKQoJewoJCSRiYXNlID0gc3ByaW50ZignLyVzLyVzLycsICR0aGlzLT5uYW1lc3BhY2UsICR0aGlzLT5yZXN0X2Jhc2UpOwoJCSR1cmwgPSAkYmFzZSAuICR0cmFuc2FjdGlvbi0+aWQ7CgoJCS8vIEVudGl0eSBtZXRhLgoJCSRsaW5rcyA9IGFycmF5KAoJCQknc2VsZicgPT4gYXJyYXkoCgkJCQknaHJlZicgPT4gcmVzdF91cmwoJHVybCksCgkJCSksCgkJCSdjb2xsZWN0aW9uJyA9PiBhcnJheSgKCQkJCSdocmVmJyA9PiByZXN0X3VybCgkYmFzZSksCgkJCSksCgkJCSd1c2VyJyA9PiBhcnJheSgKCQkJCSdocmVmJyA9PiByZXN0X3VybChjYl9yZXN0X2dldF91c2VyX3VybCgkdHJhbnNhY3Rpb24tPnVzZXJfaWQpKSwKCQkJCSdlbWJlZGRhYmxlJyA9PiB0cnVlLAoJCQkpLAoJCSk7CgoJCQoJCXJldHVybiBhcHBseV9maWx0ZXJzKCdjYl9yZXN0X3RyYW5zYWN0aW9uX3ByZXBhcmVfbGlua3MnLCAkbGlua3MsICR0cmFuc2FjdGlvbik7Cgl9CgoJcHJvdGVjdGVkIGZ1bmN0aW9uIGNhbl9zZWUoJHJlcXVlc3QpCgl7CgkJcmV0dXJuIGNiX3RyYW5zYWN0aW9uX3VzZXJfY2FuX3JlYWQoCgkJCSR0aGlzLT5nZXRfdHJhbnNhY3Rpb25fb2JqZWN0KCRyZXF1ZXN0KSwKCQkJYnBfbG9nZ2VkaW5fdXNlcl9pZCgpCgkJKTsKCX0KCglwdWJsaWMgZnVuY3Rpb24gZ2V0X3RyYW5zYWN0aW9uX29iamVjdCgkcmVxdWVzdCkKCXsKCQkkdHJhbnNhY3Rpb25faWQgPSBpc19udW1lcmljKCRyZXF1ZXN0KSA/ICRyZXF1ZXN0IDogKGludCkgJHJlcXVlc3RbJ2lkJ107CgoJCSR0cmFuc2FjdGlvbiA9IGNiX3RyYW5zYWN0aW9uX2dldF9zcGVjaWZpYygKCQkJYXJyYXkoCgkJCQkndHJhbnNhY3Rpb25faWRzJyA9PiBhcnJheSgkdHJhbnNhY3Rpb25faWQpLAoJCQkpCgkJKTsKCgkJaWYgKGlzX2FycmF5KCR0cmFuc2FjdGlvbikgJiYgIWVtcHR5KCR0cmFuc2FjdGlvblsndHJhbnNhY3Rpb25zJ11bMF0pKSB7CgkJCXJldHVybiAkdHJhbnNhY3Rpb25bJ3RyYW5zYWN0aW9ucyddWzBdOwoJCX0KCgkJcmV0dXJuICcnOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBnZXRfZW5kcG9pbnRfYXJnc19mb3JfaXRlbV9zY2hlbWEoJG1ldGhvZCA9IFdQX1JFU1RfU2VydmVyOjpDUkVBVEFCTEUpCgl7CgkJJGFyZ3MgPSBXUF9SRVNUX0NvbnRyb2xsZXI6OmdldF9lbmRwb2ludF9hcmdzX2Zvcl9pdGVtX3NjaGVtYSgkbWV0aG9kKTsKCQkka2V5ID0gJ2dldF9pdGVtJzsKCgkJaWYgKFdQX1JFU1RfU2VydmVyOjpDUkVBVEFCTEUgPT09ICRtZXRob2QgfHwgV1BfUkVTVF9TZXJ2ZXI6OkVESVRBQkxFID09PSAkbWV0aG9kKSB7CgkJCSRrZXkgPSAnY3JlYXRlX2l0ZW0nOwoJCQkkYXJnc1snY29udGVudCddWyd0eXBlJ10gPSAnc3RyaW5nJzsKCQkJdW5zZXQoJGFyZ3NbJ2NvbnRlbnQnXVsncHJvcGVydGllcyddKTsKCgkJCWlmIChXUF9SRVNUX1NlcnZlcjo6RURJVEFCTEUgPT09ICRtZXRob2QpIHsKCQkJCSRrZXkgPSAndXBkYXRlX2l0ZW0nOwoJCQl9CgkJfSBlbHNlaWYgKFdQX1JFU1RfU2VydmVyOjpERUxFVEFCTEUgPT09ICRtZXRob2QpIHsKCQkJJGtleSA9ICdkZWxldGVfaXRlbSc7CgkJfQoJCXJldHVybiBhcHBseV9maWx0ZXJzKCJjYl9yZXN0X3RyYW5zYWN0aW9uX3ska2V5fV9xdWVyeV9hcmd1bWVudHMiLCAkYXJncywgJG1ldGhvZCk7Cgl9CgoKCXB1YmxpYyBmdW5jdGlvbiBnZXRfaXRlbV9zY2hlbWEoKQoJewoJCSRzY2hlbWEgPSBhcnJheSgKCQkJJyRzY2hlbWEnID0+ICdodHRwOi8vanNvbi1zY2hlbWEub3JnL2RyYWZ0LTA0L3NjaGVtYSMnLAoJCQkndGl0bGUnID0+ICdjYl90cmFuc2FjdGlvbicsCgkJCSd0eXBlJyA9PiAnb2JqZWN0JywKCQkJJ3Byb3BlcnRpZXMnID0+IGFycmF5KAoJCQkJJ2lkJyA9PiBhcnJheSgKCQkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ3ZpZXcnLCAnZWRpdCcpLAoJCQkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ0EgdW5pcXVlIG51bWVyaWMgSUQgZm9yIHRoZSB0cmFuc2FjdGlvbi4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJCSdyZWFkb25seScgPT4gdHJ1ZSwKCQkJCQkndHlwZScgPT4gJ2ludGVnZXInLAoJCQkJKSwKCQkJCSdwcmltYXJ5X2l0ZW1faWQnID0+IGFycmF5KAoJCQkJCSdjb250ZXh0JyA9PiBhcnJheSgnZW1iZWQnLCAndmlldycsICdlZGl0JyksCgkJCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnVGhlIElEIG9mIHNvbWUgb3RoZXIgb2JqZWN0IHByaW1hcmlseSBhc3NvY2lhdGVkIHdpdGggdGhpcyBvbmUuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCQkndHlwZScgPT4gJ2ludGVnZXInLAoJCQkJKSwKCQkJCSdzZWNvbmRhcnlfaXRlbV9pZCcgPT4gYXJyYXkoCgkJCQkJJ2NvbnRleHQnID0+IGFycmF5KCdlbWJlZCcsICd2aWV3JywgJ2VkaXQnKSwKCQkJCQknZGVzY3JpcHRpb24nID0+IF9fKCdUaGUgSUQgb2Ygc29tZSBvdGhlciBvYmplY3QgYWxzbyBhc3NvY2lhdGVkIHdpdGggdGhpcyBvbmUuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCQkndHlwZScgPT4gJ2ludGVnZXInLAoJCQkJKSwKCQkJCSd1c2VyX2lkJyA9PiBhcnJheSgKCQkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ3ZpZXcnLCAnZWRpdCcpLAoJCQkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ1RoZSBJRCBmb3IgdGhlIGF1dGhvciBvZiB0aGUgdHJhbnNhY3Rpb24uJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCQkndHlwZScgPT4gJ2ludGVnZXInLAoJCQkJKSwKCQkJCSduYW1lJyA9PiBhcnJheSgKCQkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ3ZpZXcnLCAnZWRpdCcpLAoJCQkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ1VzZXJcJ3MgZGlzcGxheSBuYW1lIGZvciB0aGUgdHJhbnNhY3Rpb24uJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCQkndHlwZScgPT4gJ3N0cmluZycsCgkJCQkpLAoJCQkJJ2xpbmsnID0+IGFycmF5KAoJCQkJCSdjb250ZXh0JyA9PiBhcnJheSgnZW1iZWQnLCAndmlldycsICdlZGl0JyksCgkJCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnVGhlIHBlcm1hbGluayB0byB0aGlzIHRyYW5zYWN0aW9uIG9uIHRoZSBzaXRlLicsICdjb25mZXR0aS1iaXRzJyksCgkJCQkJJ2Zvcm1hdCcgPT4gJ3VyaScsCgkJCQkJJ3R5cGUnID0+ICdzdHJpbmcnLAoJCQkJKSwKCQkJCSdjb21wb25lbnQnID0+IGFycmF5KAoJCQkJCSdjb250ZXh0JyA9PiBhcnJheSgnZW1iZWQnLCAndmlldycsICdlZGl0JyksCgkJCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnVGhlIGFjdGl2ZSBCdWRkeVByZXNzIGNvbXBvbmVudCB0aGUgdHJhbnNhY3Rpb24gcmVsYXRlcyB0by4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJCSd0eXBlJyA9PiAnc3RyaW5nJywKCQkJCQknZW51bScgPT4gYXJyYXlfa2V5cyhidWRkeXByZXNzKCktPmFjdGl2ZV9jb21wb25lbnRzKSwKCQkJCQknYXJnX29wdGlvbnMnID0+IGFycmF5KAoJCQkJCQknc2FuaXRpemVfY2FsbGJhY2snID0+ICdzYW5pdGl6ZV9rZXknLAoJCQkJCSksCgkJCQkpLAoJCQkJJ3R5cGUnID0+IGFycmF5KAoJCQkJCSdjb250ZXh0JyA9PiBhcnJheSgnZW1iZWQnLCAndmlldycsICdlZGl0JyksCgkJCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnVGhlIHRyYW5zYWN0aW9uIHR5cGUgb2YgdGhlIHRyYW5zYWN0aW9uLicsICdjb25mZXR0aS1iaXRzJyksCgkJCQkJJ3R5cGUnID0+ICdzdHJpbmcnLAoJCQkJCSdlbnVtJyA9PiBhcnJheV9rZXlzKGNiX3RyYW5zYWN0aW9uX2dldF90eXBlcygpKSwKCQkJCQknYXJnX29wdGlvbnMnID0+IGFycmF5KAoJCQkJCQknc2FuaXRpemVfY2FsbGJhY2snID0+ICdzYW5pdGl6ZV9rZXknLAoJCQkJCSksCgkJCQkpLAoJCQkJJ3RpdGxlJyA9PiBhcnJheSgKCQkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ3ZpZXcnLCAnZWRpdCcpLAoJCQkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ1RoZSBkZXNjcmlwdGlvbiBvZiB0aGUgdHJhbnNhY3Rpb25cJ3MgdHlwZSAoZWc6IFVzZXJuYW1lIHBvc3RlZCBhbiB1cGRhdGUpJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJCQkndHlwZScgPT4gJ3N0cmluZycsCgkJCQkJJ3JlYWRvbmx5JyA9PiB0cnVlLAoJCQkJCSdhcmdfb3B0aW9ucycgPT4gYXJyYXkoCgkJCQkJCSdzYW5pdGl6ZV9jYWxsYmFjaycgPT4gJ3Nhbml0aXplX3RleHRfZmllbGQnLAoJCQkJCSksCgkJCQkpLAoJCQkJJ2NvbnRlbnQnID0+IGFycmF5KAoJCQkJCSdjb250ZXh0JyA9PiBhcnJheSgnZW1iZWQnLCAndmlldycsICdlZGl0JyksCgkJCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnQWxsb3dlZCBIVE1MIGNvbnRlbnQgZm9yIHRoZSB0cmFuc2FjdGlvbi4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJCSd0eXBlJyA9PiAnb2JqZWN0JywKCQkJCQknYXJnX29wdGlvbnMnID0+IGFycmF5KAoJCQkJCQknc2FuaXRpemVfY2FsbGJhY2snID0+IG51bGwsCgkJCQkJCS8vIE5vdGU6IHNhbml0aXphdGlvbiBpbXBsZW1lbnRlZCBpbiBzZWxmOjpwcmVwYXJlX2l0ZW1fZm9yX2RhdGFiYXNlKCkuCgkJCQkJCSd2YWxpZGF0ZV9jYWxsYmFjaycgPT4gbnVsbCwKCQkJCQkJLy8gTm90ZTogdmFsaWRhdGlvbiBpbXBsZW1lbnRlZCBpbiBzZWxmOjpwcmVwYXJlX2l0ZW1fZm9yX2RhdGFiYXNlKCkuCgkJCQkJKSwKCQkJCQkncHJvcGVydGllcycgPT4gYXJyYXkoCgkJCQkJCSdyYXcnID0+IGFycmF5KAoJCQkJCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnQ29udGVudCBmb3IgdGhlIHRyYW5zYWN0aW9uLCBhcyBpdCBleGlzdHMgaW4gdGhlIGRhdGFiYXNlLicsICdjb25mZXR0aS1iaXRzJyksCgkJCQkJCQkndHlwZScgPT4gJ3N0cmluZycsCgkJCQkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ2VkaXQnKSwKCQkJCQkJKSwKCQkJCQkJJ3JlbmRlcmVkJyA9PiBhcnJheSgKCQkJCQkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ0hUTUwgY29udGVudCBmb3IgdGhlIHRyYW5zYWN0aW9uLCB0cmFuc2Zvcm1lZCBmb3IgZGlzcGxheS4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJCQkJJ3R5cGUnID0+ICdzdHJpbmcnLAoJCQkJCQkJJ2NvbnRleHQnID0+IGFycmF5KCdlbWJlZCcsICd2aWV3JywgJ2VkaXQnKSwKCQkJCQkJCSdyZWFkb25seScgPT4gdHJ1ZSwKCQkJCQkJKSwKCQkJCQkpLAoJCQkJKSwKCQkJCSdkYXRlJyA9PiBhcnJheSgKCQkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ3ZpZXcnLCAnZWRpdCcpLAoJCQkJCSdkZXNjcmlwdGlvbicgPT4gX18oIlRoZSBkYXRlIHRoZSB0cmFuc2FjdGlvbiB3YXMgcHVibGlzaGVkLCBpbiB0aGUgc2l0ZSdzIHRpbWV6b25lLiIsICdjb25mZXR0aS1iaXRzJyksCgkJCQkJJ3R5cGUnID0+ICdzdHJpbmcnLAoJCQkJCSdmb3JtYXQnID0+ICdkYXRlLXRpbWUnLAoJCQkJKSwKCQkJCSdzdGF0dXMnID0+IGFycmF5KAoJCQkJCSdjb250ZXh0JyA9PiBhcnJheSgnZW1iZWQnLCAndmlldycsICdlZGl0JyksCgkJCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnV2hldGhlciB0aGUgdHJhbnNhY3Rpb24gaGFzIGJlZW4gbWFya2VkIGFzIHNwYW0gb3Igbm90LicsICdjb25mZXR0aS1iaXRzJyksCgkJCQkJJ3R5cGUnID0+ICdzdHJpbmcnLAoJCQkJCSdlbnVtJyA9PiBhcnJheSgncHVibGlzaGVkJywgJ3NwYW0nKSwKCQkJCQkncmVhZG9ubHknID0+IHRydWUsCgkJCQkJJ2FyZ19vcHRpb25zJyA9PiBhcnJheSgKCQkJCQkJJ3Nhbml0aXplX2NhbGxiYWNrJyA9PiAnc2FuaXRpemVfa2V5JywKCQkJCQkpLAoJCQkJKSwKCQkJCSdjYW5fZGVsZXRlJyA9PiBhcnJheSgKCQkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ3ZpZXcnLCAnZWRpdCcpLAoJCQkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ1doZXRoZXIgb3Igbm90IHVzZXIgaGF2ZSB0aGUgZGVsZXRlIGFjY2VzcyBmb3IgdGhlIHRyYW5zYWN0aW9uIG9iamVjdC4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJCSd0eXBlJyA9PiAnYm9vbGVhbicsCgkJCQkJJ3JlYWRvbmx5JyA9PiB0cnVlLAoJCQkJKSwKCQkJCSdjb250ZW50X3N0cmlwcGVkJyA9PiBhcnJheSgKCQkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ3ZpZXcnLCAnZWRpdCcpLAoJCQkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ0NvbnRlbnQgZm9yIHRoZSB0cmFuc2FjdGlvbiB3aXRob3V0IEhUTUwgdGFncy4nLCAnY29uZmV0dGktYml0cycpLAoJCQkJCSd0eXBlJyA9PiAnc3RyaW5nJywKCQkJCQkncmVhZG9ubHknID0+IHRydWUsCgkJCQkpLAoJCQkpLAoJCSk7CgoJCS8vIEF2YXRhcnMuCgkJaWYgKHRydWUgPT09IGJ1ZGR5cHJlc3MoKS0+YXZhdGFyLT5zaG93X2F2YXRhcnMpIHsKCQkJJGF2YXRhcl9wcm9wZXJ0aWVzID0gYXJyYXkoKTsKCgkJCSRhdmF0YXJfcHJvcGVydGllc1snZnVsbCddID0gYXJyYXkoCgkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ3ZpZXcnLCAnZWRpdCcpLAoKCQkJCSdkZXNjcmlwdGlvbicgPT4gc3ByaW50ZihfXygnQXZhdGFyIFVSTCB3aXRoIGZ1bGwgaW1hZ2Ugc2l6ZSAoJTEkZCB4ICUyJGQgcGl4ZWxzKS4nLCAnY29uZmV0dGktYml0cycpLCBudW1iZXJfZm9ybWF0X2kxOG4oY2JfY29yZV9hdmF0YXJfZnVsbF93aWR0aCgpKSwgbnVtYmVyX2Zvcm1hdF9pMThuKGNiX2NvcmVfYXZhdGFyX2Z1bGxfaGVpZ2h0KCkpKSwKCQkJCSd0eXBlJyA9PiAnc3RyaW5nJywKCQkJCSdmb3JtYXQnID0+ICd1cmknLAoJCQkpOwoKCQkJJGF2YXRhcl9wcm9wZXJ0aWVzWyd0aHVtYiddID0gYXJyYXkoCgkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ3ZpZXcnLCAnZWRpdCcpLAoKCQkJCSdkZXNjcmlwdGlvbicgPT4gc3ByaW50ZihfXygnQXZhdGFyIFVSTCB3aXRoIHRodW1iIGltYWdlIHNpemUgKCUxJGQgeCAlMiRkIHBpeGVscykuJywgJ2NvbmZldHRpLWJpdHMnKSwgbnVtYmVyX2Zvcm1hdF9pMThuKGNiX2NvcmVfYXZhdGFyX3RodW1iX3dpZHRoKCkpLCBudW1iZXJfZm9ybWF0X2kxOG4oY2JfY29yZV9hdmF0YXJfdGh1bWJfaGVpZ2h0KCkpKSwKCQkJCSd0eXBlJyA9PiAnc3RyaW5nJywKCQkJCSdmb3JtYXQnID0+ICd1cmknLAoJCQkpOwoKCQkJJHNjaGVtYVsncHJvcGVydGllcyddWyd1c2VyX2F2YXRhciddID0gYXJyYXkoCgkJCQknY29udGV4dCcgPT4gYXJyYXkoJ2VtYmVkJywgJ3ZpZXcnLCAnZWRpdCcpLAoJCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnQXZhdGFyIFVSTHMgZm9yIHRoZSBhdXRob3Igb2YgdGhlIHRyYW5zYWN0aW9uLicsICdjb25mZXR0aS1iaXRzJyksCgkJCQkndHlwZScgPT4gJ29iamVjdCcsCgkJCQkncmVhZG9ubHknID0+IHRydWUsCgkJCQkncHJvcGVydGllcycgPT4gJGF2YXRhcl9wcm9wZXJ0aWVzLAoJCQkpOwoJCX0KCgkJcmV0dXJuIGFwcGx5X2ZpbHRlcnMoJ2NiX3Jlc3RfdHJhbnNhY3Rpb25fc2NoZW1hJywgJHRoaXMtPmFkZF9hZGRpdGlvbmFsX2ZpZWxkc19zY2hlbWEoJHNjaGVtYSkpOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBnZXRfY29sbGVjdGlvbl9wYXJhbXMoKQoJewoJCSRwYXJhbXMgPSBwYXJlbnQ6OmdldF9jb2xsZWN0aW9uX3BhcmFtcygpOwoJCSRwYXJhbXNbJ2NvbnRleHQnXVsnZGVmYXVsdCddID0gJ3ZpZXcnOwoKCQkkcGFyYW1zWydleGNsdWRlJ10gPSBhcnJheSgKCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnRW5zdXJlIHJlc3VsdCBzZXQgZXhjbHVkZXMgc3BlY2lmaWMgSURzLicsICdjb25mZXR0aS1iaXRzJyksCgkJCSdkZWZhdWx0JyA9PiBhcnJheSgpLAoJCQkndHlwZScgPT4gJ2FycmF5JywKCQkJJ2l0ZW1zJyA9PiBhcnJheSgndHlwZScgPT4gJ2ludGVnZXInKSwKCQkJJ3Nhbml0aXplX2NhbGxiYWNrJyA9PiAnd3BfcGFyc2VfaWRfbGlzdCcsCgkJCSd2YWxpZGF0ZV9jYWxsYmFjaycgPT4gJ3Jlc3RfdmFsaWRhdGVfcmVxdWVzdF9hcmcnLAoJCSk7CgoJCSRwYXJhbXNbJ2luY2x1ZGUnXSA9IGFycmF5KAoJCQknZGVzY3JpcHRpb24nID0+IF9fKCdFbnN1cmUgcmVzdWx0IHNldCBpbmNsdWRlcyBzcGVjaWZpYyBJRHMuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJJ2RlZmF1bHQnID0+IGFycmF5KCksCgkJCSd0eXBlJyA9PiAnYXJyYXknLAoJCQknaXRlbXMnID0+IGFycmF5KCd0eXBlJyA9PiAnaW50ZWdlcicpLAoJCQknc2FuaXRpemVfY2FsbGJhY2snID0+ICd3cF9wYXJzZV9pZF9saXN0JywKCQkJJ3ZhbGlkYXRlX2NhbGxiYWNrJyA9PiAncmVzdF92YWxpZGF0ZV9yZXF1ZXN0X2FyZycsCgkJKTsKCgkJJHBhcmFtc1snb3JkZXInXSA9IGFycmF5KAoJCQknZGVzY3JpcHRpb24nID0+IF9fKCdPcmRlciBzb3J0IGF0dHJpYnV0ZSBhc2NlbmRpbmcgb3IgZGVzY2VuZGluZy4nLCAnY29uZmV0dGktYml0cycpLAoJCQknZGVmYXVsdCcgPT4gJ2Rlc2MnLAoJCQkndHlwZScgPT4gJ3N0cmluZycsCgkJCSdlbnVtJyA9PiBhcnJheSgnYXNjJywgJ2Rlc2MnKSwKCQkJJ3Nhbml0aXplX2NhbGxiYWNrJyA9PiAnc2FuaXRpemVfa2V5JywKCQkJJ3ZhbGlkYXRlX2NhbGxiYWNrJyA9PiAncmVzdF92YWxpZGF0ZV9yZXF1ZXN0X2FyZycsCgkJKTsKCgkJJHBhcmFtc1snYWZ0ZXInXSA9IGFycmF5KAoJCQknZGVzY3JpcHRpb24nID0+IF9fKCdMaW1pdCByZXN1bHQgc2V0IHRvIGl0ZW1zIHB1Ymxpc2hlZCBhZnRlciBhIGdpdmVuIElTTzg2MDEgY29tcGxpYW50IGRhdGUuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJJ3R5cGUnID0+ICdzdHJpbmcnLAoJCQknZm9ybWF0JyA9PiAnZGF0ZS10aW1lJywKCQkJJ3ZhbGlkYXRlX2NhbGxiYWNrJyA9PiAncmVzdF92YWxpZGF0ZV9yZXF1ZXN0X2FyZycsCgkJKTsKCgkJJHBhcmFtc1sndXNlcl9pZCddID0gYXJyYXkoCgkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ0xpbWl0IHJlc3VsdCBzZXQgdG8gaXRlbXMgY3JlYXRlZCBieSBhIHNwZWNpZmljIHVzZXIgKElEKS4nLCAnY29uZmV0dGktYml0cycpLAoJCQknZGVmYXVsdCcgPT4gMCwKCQkJJ3R5cGUnID0+ICdpbnRlZ2VyJywKCQkJJ3Nhbml0aXplX2NhbGxiYWNrJyA9PiAnYWJzaW50JywKCQkJJ3ZhbGlkYXRlX2NhbGxiYWNrJyA9PiAncmVzdF92YWxpZGF0ZV9yZXF1ZXN0X2FyZycsCgkJKTsKCgkJJHBhcmFtc1snc3RhdHVzJ10gPSBhcnJheSgKCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnTGltaXQgcmVzdWx0IHNldCB0byBpdGVtcyB3aXRoIGEgc3BlY2lmaWMgc3RhdHVzLicsICdjb25mZXR0aS1iaXRzJyksCgkJCSdkZWZhdWx0JyA9PiAnaGFtX29ubHknLAoJCQkndHlwZScgPT4gJ3N0cmluZycsCgkJCSdlbnVtJyA9PiBhcnJheSgnaGFtX29ubHknLCAnc3BhbV9vbmx5JywgJ2FsbCcpLAoJCQknc2FuaXRpemVfY2FsbGJhY2snID0+ICdzYW5pdGl6ZV9rZXknLAoJCQkndmFsaWRhdGVfY2FsbGJhY2snID0+ICdyZXN0X3ZhbGlkYXRlX3JlcXVlc3RfYXJnJywKCQkpOwoKCQkkcGFyYW1zWydzY29wZSddID0gYXJyYXkoCgkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ0xpbWl0IHJlc3VsdCBzZXQgdG8gaXRlbXMgd2l0aCBhIHNwZWNpZmljIHNjb3BlLicsICdjb25mZXR0aS1iaXRzJyksCgkJCSd0eXBlJyA9PiAnc3RyaW5nJywKCQkJJ2VudW0nID0+IGFycmF5KCdqdXN0LW1lJywgJ2ZyaWVuZHMnLCAnZ3JvdXBzJywgJ2Zhdm9yaXRlcycsICdtZW50aW9ucycsICdmb2xsb3dpbmcnKSwKCQkJJ3Nhbml0aXplX2NhbGxiYWNrJyA9PiAnc2FuaXRpemVfdGV4dF9maWVsZCcsCgkJCSd2YWxpZGF0ZV9jYWxsYmFjaycgPT4gJ3Jlc3RfdmFsaWRhdGVfcmVxdWVzdF9hcmcnLAoJCSk7CgoJCSRwYXJhbXNbJ3ByaW1hcnlfaWQnXSA9IGFycmF5KAoJCQknZGVzY3JpcHRpb24nID0+IF9fKCdMaW1pdCByZXN1bHQgc2V0IHRvIGl0ZW1zIHdpdGggYSBzcGVjaWZpYyBwcmltZSBhc3NvY2lhdGlvbiBJRC4nLCAnY29uZmV0dGktYml0cycpLAoJCQknZGVmYXVsdCcgPT4gMCwKCQkJJ3R5cGUnID0+ICdpbnRlZ2VyJywKCQkJJ3Nhbml0aXplX2NhbGxiYWNrJyA9PiAnYWJzaW50JywKCQkJJ3ZhbGlkYXRlX2NhbGxiYWNrJyA9PiAncmVzdF92YWxpZGF0ZV9yZXF1ZXN0X2FyZycsCgkJKTsKCgkJJHBhcmFtc1snc2Vjb25kYXJ5X2lkJ10gPSBhcnJheSgKCQkJJ2Rlc2NyaXB0aW9uJyA9PiBfXygnTGltaXQgcmVzdWx0IHNldCB0byBpdGVtcyB3aXRoIGEgc3BlY2lmaWMgc2Vjb25kYXJ5IGFzc29jaWF0aW9uIElELicsICdjb25mZXR0aS1iaXRzJyksCgkJCSdkZWZhdWx0JyA9PiAwLAoJCQkndHlwZScgPT4gJ2ludGVnZXInLAoJCQknc2FuaXRpemVfY2FsbGJhY2snID0+ICdhYnNpbnQnLAoJCQkndmFsaWRhdGVfY2FsbGJhY2snID0+ICdyZXN0X3ZhbGlkYXRlX3JlcXVlc3RfYXJnJywKCQkpOwoKCQkkcGFyYW1zWydjb21wb25lbnQnXSA9IGFycmF5KAoJCQknZGVzY3JpcHRpb24nID0+IF9fKCdMaW1pdCByZXN1bHQgc2V0IHRvIGl0ZW1zIHdpdGggYSBzcGVjaWZpYyBhY3RpdmUgQnVkZHlQcmVzcyBjb21wb25lbnQuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJJ3R5cGUnID0+ICdzdHJpbmcnLAoJCQknZW51bScgPT4gYXJyYXlfa2V5cyhidWRkeXByZXNzKCktPmFjdGl2ZV9jb21wb25lbnRzKSwKCQkJJ3Nhbml0aXplX2NhbGxiYWNrJyA9PiAnc2FuaXRpemVfa2V5JywKCQkJJ3ZhbGlkYXRlX2NhbGxiYWNrJyA9PiAncmVzdF92YWxpZGF0ZV9yZXF1ZXN0X2FyZycsCgkJKTsKCgkJJHBhcmFtc1sndHlwZSddID0gYXJyYXkoCgkJCSdkZXNjcmlwdGlvbicgPT4gX18oJ0xpbWl0IHJlc3VsdCBzZXQgdG8gaXRlbXMgd2l0aCBhIHNwZWNpZmljIHRyYW5zYWN0aW9uIHR5cGUuJywgJ2NvbmZldHRpLWJpdHMnKSwKCQkJJ3R5cGUnID0+ICdzdHJpbmcnLAoJCQknZW51bScgPT4gYXJyYXlfa2V5cyhjYl90cmFuc2FjdGlvbl9nZXRfdHlwZXMoKSksCgkJCSdzYW5pdGl6ZV9jYWxsYmFjaycgPT4gJ3Nhbml0aXplX2tleScsCgkJCSd2YWxpZGF0ZV9jYWxsYmFjaycgPT4gJ3Jlc3RfdmFsaWRhdGVfcmVxdWVzdF9hcmcnLAoJCSk7CgoJCSRwYXJhbXNbJ3ByaXZhY3knXSA9IGFycmF5KAoJCQknZGVzY3JpcHRpb24nID0+IF9fKCdQcml2YWN5IG9mIHRoZSB0cmFuc2FjdGlvbi4nLCAnY29uZmV0dGktYml0cycpLAoJCQkndHlwZScgPT4gJ2FycmF5JywKCQkJJ2l0ZW1zJyA9PiBhcnJheSgKCQkJCSd0eXBlJyA9PiAnc3RyaW5nJywKCQkJCSdlbnVtJyA9PiBhcnJheSgncHVibGljJywgJ2xvZ2dlZGluJywgJ29ubHltZScsICdmcmllbmRzJywgJ21lZGlhJyksCgkJCSksCgkJCSdzYW5pdGl6ZV9jYWxsYmFjaycgPT4gJ2NiX3Jlc3Rfc2FuaXRpemVfc3RyaW5nX2xpc3QnLAoJCQkndmFsaWRhdGVfY2FsbGJhY2snID0+ICdyZXN0X3ZhbGlkYXRlX3JlcXVlc3RfYXJnJywKCQkpOwoKCQlyZXR1cm4gYXBwbHlfZmlsdGVycygnY2JfcmVzdF90cmFuc2FjdGlvbl9jb2xsZWN0aW9uX3BhcmFtcycsICRwYXJhbXMpOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBnZXRfdHJhbnNhY3Rpb25fZmF2b3JpdGVfY291bnQoJHRyYW5zYWN0aW9uX2lkKQoJewoKCQlpZiAoZW1wdHkoJHRyYW5zYWN0aW9uX2lkKSkgewoJCQlyZXR1cm47CgkJfQoKCQkkZmF2X2NvdW50ID0gY2JfdHJhbnNhY3Rpb25fZ2V0X21ldGEoJHRyYW5zYWN0aW9uX2lkLCAnZmF2b3JpdGVfY291bnQnLCB0cnVlKTsKCgkJcmV0dXJuICghZW1wdHkoJGZhdl9jb3VudCkgPyAkZmF2X2NvdW50IDogMCk7Cgl9CgoJcHVibGljIGZ1bmN0aW9uIGNiX3Jlc3RfdHJhbnNhY3Rpb25fY29udGVudF92YWxpZGF0ZSgkcmVxdWVzdCkKCXsKCQkkdG9vbGJhcl9vcHRpb24gPSBmYWxzZTsKCgkJaWYgKCFlbXB0eSgkcmVxdWVzdFsnY29udGVudCddKSkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKCQlyZXR1cm4gJHRvb2xiYXJfb3B0aW9uOwoJfQoKCXB1YmxpYyBmdW5jdGlvbiBjYl9yZXN0X3RyYW5zYWN0aW9uX2RlZmF1bHRfc2NvcGUoJHNjb3BlID0gJ2FsbCcsICR1c2VyX2lkID0gMCkKCXsKCQkkbmV3X3Njb3BlID0gYXJyYXkoKTsKCgkJaWYgKGJwX2xvZ2dlZGluX3VzZXJfaWQoKSAmJiAoJ2FsbCcgPT09ICRzY29wZSB8fCBlbXB0eSgkc2NvcGUpKSkgewoKCQkJJG5ld19zY29wZVtdID0gJ3B1YmxpYyc7CgoJCQkkbmV3X3Njb3BlW10gPSAnanVzdC1tZSc7CgoJCQlpZiAoZW1wdHkoJHVzZXJfaWQpKSB7CgkJCQkkbmV3X3Njb3BlW10gPSAncHVibGljJzsKCQkJfQoJCX0gZWxzZWlmICghYnBfbG9nZ2VkaW5fdXNlcl9pZCgpICYmICgnYWxsJyA9PT0gJHNjb3BlIHx8IGVtcHR5KCRzY29wZSkpKSB7CgkJCSRuZXdfc2NvcGVbXSA9ICdwdWJsaWMnOwoJCX0KCgkJJG5ld19zY29wZSA9IGFycmF5X3VuaXF1ZSgkbmV3X3Njb3BlKTsKCgkJaWYgKGVtcHR5KCRuZXdfc2NvcGUpKSB7CgkJCSRuZXdfc2NvcGUgPSAoYXJyYXkpICRzY29wZTsKCQl9CgoJCSRuZXdfc2NvcGUgPSBhcHBseV9maWx0ZXJzKCdjYl9yZXN0X3RyYW5zYWN0aW9uX2RlZmF1bHRfc2NvcGUnLCAkbmV3X3Njb3BlKTsKCgkJcmV0dXJuIGltcGxvZGUoJywnLCAkbmV3X3Njb3BlKTsKCX0KfQovKi8iO3M6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAbmFtZXNwYWNlcyI7YTowOnt9czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBpbmNsdWRlcyI7YTowOnt9czo0NDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBmdW5jdGlvbnMiO2E6MDp7fXM6NDQ6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAY29uc3RhbnRzIjthOjA6e31zOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGNsYXNzZXMiO2E6MDp7fXM6NDU6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAaW50ZXJmYWNlcyI7YTowOnt9czo0MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQB0cmFpdHMiO2E6MDp7fXM6NDA6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAZW51bXMiO2E6MDp7fXM6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAbWV0YWRhdGEiO2E6MDp7fX0=";